(()=>{"use strict";var t={d:(e,s)=>{for(var n in s)t.o(s,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{changes:()=>S,compute:()=>B,init:()=>D,resetChanges:()=>T});class s extends class{constructor(){this.memory=new Map}get(t,e){return this.memory.get(t)?.get(e)}set(t,e,s){const{memory:n}=this;n.has(t)||n.set(t,new Map),n.get(t).set(e,s)}rows(){return Array.from(this.memory.keys())}cols(t){return Array.from(this.memory.get(t)?.keys()||[])}del(t,e){this.memory.get(t)?.delete(e)}}{constructor(){super(),this.changes=[]}get(t,e){return this.memory.get(t)?.get(e)}set(t,e,s){const{memory:n,changes:o}=this;n.has(t)||n.set(t,new Map),n.get(t).set(e,s),o.push({row:t,col:e,value:s})}rows(){return Array.from(this.memory.keys())}cols(t){return Array.from(this.memory.get(t)?.keys()||[])}del(t,e){this.memory.get(t)?.delete(e)}reset(){this.changes=[]}}const n=Math.PI/180;function o(t){return Math.cos(t*n)}function r(t){return Math.sin(t*n)}async function a(t=0){return new Promise((e=>setTimeout(e,t)))}function i(t,e){return Math.floor(Math.random()*(e-t+1)+t)}const c=document.getElementById("map-background-layer").getContext("2d");c.imageSmoothingEnabled=!1;const h=document.getElementById("map-main-layer").getContext("2d");h.imageSmoothingEnabled=!1;const l=document.getElementById("player-main-layer").getContext("2d");l.imageSmoothingEnabled=!1;const y=document.getElementById("player-path-layer").getContext("2d");y.imageSmoothingEnabled=!1;const d={w:!1,a:!1,s:!1,d:!1};document.addEventListener("keydown",(({key:t})=>{switch(t){case"w":d.w=!0;break;case"a":d.a=!0;break;case"s":d.s=!0;break;case"d":d.d=!0}})),document.addEventListener("keyup",(({key:t})=>{switch(t){case"w":d.w=!1;break;case"a":d.a=!1;break;case"s":d.s=!1;break;case"d":d.d=!1}}));class u{constructor(t=250,e=250,s=30,n=0){this.x=t+s,this.y=e+s,this.rx=t,this.ry=e,this.dir=n,this.length=s}update(){this.dir++,this.dir>=360&&(this.dir=0);const{dir:t}=this,e=this.length;return this.x=this.rx+Math.round(e*o(t)-0*r(t)),this.y=this.ry+Math.round(e*r(t)+0*o(t)),{x:this.x,y:this.y}}}const g=Object.assign([],{update(){for(let t=0,e=g.length;t<e;t++)g[t].update()}});for(let t=30;t<50;t++)g.push(new u(250,250,t));const m=new Image;m.src="assets/maze.png";const f=m.width,x=m.height,p={x:100,y:100},w=Object.assign(new Array(x).fill(0).map((()=>new Array(f).fill(0))),{data:[],dir:0,reset:function(){const{data:t}=this;for(let e=0,s=x;e<s;e++)for(let s=0,n=f;s<n;s++)w[e][s]=+!t[e*f+s];for(let t=0,e=g.length;t<e;t++){const{x:e,y:s}=g[t];w[s][e]=1}w[250][250]=100},set(t){this.data=Array.from(t.filter(((t,e)=>e%4==0)))}}),M=w;class b{constructor(t,e=100){this.integrals=[],this.dir=t;const s=e;this.dx=Math.round(s*o(t)-0*r(t)),this.dy=Math.round(s*r(t)+0*o(t))}update(t,e){const[s,n,o]=function(t,e,s,n){const o=Math.abs(s-t),r=Math.abs(n-e),a=t<s?1:-1,i=e<n?1:-1;let c=o-r;const h=[];for(;;){const l=M[e]?.[t];if(100===l)return[h,void 0,{x:t,y:e}];if(void 0===l||1===l)return[h,{x:t,y:e},void 0];if(t===s&&e===n)return[h,void 0];h.push({x:t,y:e});const y=2*c;y>-r&&(c-=r,t+=a),y<o&&(c+=o,e+=i)}}(t,e,t+this.dx,e+this.dy);return this.integrals=s,[0===s.length,n,o]}}const{sqrt:k}=Math;let I,v,P,E;function D(t,e){v=[],I=e,P=t.memory,E=new s;const{x:n,y:o}=t,r=C({x:n,y:o},I);v.push({x:n,y:o,ds:0,dg:r,cost:r})}function S(){return E.changes}function T(){E.reset()}function B(){v.sort(F);const t=v.pop(),{x:e,y:s,ds:n}=t;E.set(s,e,1);for(let o=s+2;--o>=s-1;)for(let s=e+2;--s>=e-1;){const e={x:s,y:o,parent:t},r=P.get(o,s);if(s===I.x&&o===I.y)return A(e,[]);if(2===r||1===E.get(o,s))continue;const a=.95*n+C(e,t),i=C(e,I),c=a+i,h=O(e);h?h.cost>c&&(h.cost=c,h.ds=a,h.dg=i,h.parent=t):v.push({...e,cost:c,ds:a,dg:i})}}function C(t,e){const s=t.x-e.x,n=t.y-e.y;return k(s*s+n*n)}function F(t,e){return e.cost-t.cost||e.dg-t.dg}function A(t,e){e.push(t);const{parent:s}=t;return s?A(s,e):e}function O(t){const{x:e,y:s}=t;for(let t=v.length;--t>=0;){const n=v[t];if(e===n.x&&s===n.y)return n}}const j=l.createImageData(f+2,x+2);let $=y.createImageData(f+2,x+2);const L=4*(f+2);function G(){const t=p.y+1,e=p.x+1,{data:s}=$,n=S();for(let o=0,r=n.length;o<r;o++){const{row:r,col:a,value:i}=n[o],c=(r+t)*L+4*(a+e);switch(i){case 1:s[c]=255;break;case 2:s[c+1]=255}s[c+3]=255}y.putImageData($,0,0),T()}const R=new class{constructor(t=0,n=0,o=360){this.memory=new s,this.dir=0,this.rays=[],this.path=[],this.goalDirections=[],this.x=t,this.y=n,this.pathfinder=e;for(let t=0;t<360;t+=360/o)this.rays.push(new b(t,50))}findGoal(t,e){if(this.goalDirections.length>10){const t=100,e=0;for(const{x:s,y:n,dir:a}of this.goalDirections){const i=s+Math.round(t*o(a)-e*r(a)),c=n+Math.round(t*r(a)+e*o(a))-n,h=s-i,l=c*s+h*n;for(const{x:s,y:n,dir:a}of this.goalDirections){const i=s+Math.round(t*o(a)-e*r(a)),y=n+Math.round(t*r(a)+e*o(a))-n,d=s-i,u=y*s+d*n,g=c*d-y*h;if(0!==g)return void(this.goal={x:Math.round((d*l-h*u)/g),y:Math.round((c*u-y*l)/g)})}}}const{x:s,y:n,dir:a}=this;this.goalDirections.push({x:s+t,y:n+e,dir:a}),this.path.push({x:s+i(-1,1),y:n+i(-1,1)})}async update(t,e){this.dir=function(t,e,s,n){const o=t-250,r=e-250,a=180*Math.atan2(-r,-o)/Math.PI;return a<0?a+360:a}(this.x+t,this.y+e),this.x+t===this.goal?.x&&this.y+e===this.goal?.y&&(this.goal=void 0,this.goalDirections=[]),this.goal||this.findGoal(t,e),this.goal&&0===this.path.length&&await this.computePath(t,e);const{x:s,y:n}=this.path.pop();this.x=s,this.y=n;const a=[],{rays:i,memory:c}=this;for(let h=0,l=i.length;h<l;h++){const l=i[h],[y,d,u]=l.update(this.x+t,this.y+e);if(u&&(this.goal=u,c.set(u.y-e,u.x-t,3)),y){const{dir:a}=l,i=Math.round(o(a)-r(a)),c=Math.round(r(a)+o(a));return this.path=[{x:s+i,y:n+c}],this.update(t,e)}d&&a.push(d)}c.reset();for(let s=0,n=a.length;s<n;s++){const{x:n,y:o}=a[s];2!==c.get(o-e,n-t)&&c.set(o-e,n-t,2)}for(let s=0,n=i.length;s<n;s++){const{integrals:n}=i[s];for(let s=0,o=n.length;s<o;s++){const{x:o,y:r}=n[s];1!==c.get(r-e,o-t)&&c.set(r-e,o-t,1)}}}async computePath(t,e){const{path:s,goal:n,pathfinder:o}=this;if(0===s.length&&n){let s;for(o.init(this,{x:n.x-t,y:n.y-e}),$=y.createImageData(f+2,x+2);!s;)s=o.compute(),G(),await a();this.path=s}}},_=new class{constructor(){this.time=0,this.start()}start(){this.time=performance.now()}end(){return performance.now()-this.time}},q=document.getElementById("fps"),z=document.getElementById("player-pos"),H=document.getElementById("player-actual-pos"),J=document.getElementById("player-estimate");let K=0;async function N(){_.start(),g.update(),M.reset(),await R.update(p.x,p.y),Q(N)}function Q(t){!function(){h.clearRect(0,0,f,x),h.strokeStyle="#CDCDCD";const{rays:t,dir:e}=R;for(let e=0,s=t.length;e<s;e++){const s=t[e].integrals;s[0]&&(h.beginPath(),h.moveTo(s[0].x,s[0].y),h.lineTo(s[s.length-1].x,s[s.length-1].y),h.stroke())}h.fillStyle="#000000",g.forEach((({x:t,y:e})=>{h.fillRect(t,e,1,1),h.fill()}));const s=R.x+p.x,n=R.y+p.y;h.fillStyle="#FF0000",h.beginPath(),h.arc(s,n,2,0,2*Math.PI),h.fill()}(),function(){const t=p.y+1,e=p.x+1,{changes:s}=R.memory,{data:n}=j;let o;for(let r=0,a=s.length;r<a;r++){const{row:a,col:i,value:c}=s[r],h=(a+t)*L+4*(i+e);switch(c){case 1:n[h]=50,n[h+1]=205,n[h+2]=50;break;case 2:n[h]=0,n[h+1]=0,n[h+2]=0;break;case 3:n[h]=0,n[h+1]=0,n[h+2]=255,o={x:i,y:a}}n[h+3]=255}l.putImageData(j,0,0),l.fillStyle="#FF0000",l.beginPath(),l.arc(R.x+e,R.y+t,2,0,2*Math.PI),l.fill(),o&&(l.fillStyle="#0000FF",l.beginPath(),l.arc(o.x+e,o.y+t,2,0,2*Math.PI),l.fill())}(),z.innerText=`memory x: ${R.x}, y: ${R.y}`,J.innerText=R.goal?`x: ${R.goal.x}, y: ${R.goal.y}`:"searching",H.innerText=`actual x: ${R.x+p.x}, y: ${R.y+p.y}`,K=_.end(),setTimeout(t,6.944444444444445-K)}window.onload=async function(){console.log("Load ok"),c.drawImage(m,0,0),M.set(c.getImageData(0,0,f,x).data),c.fillStyle="#0000FF",c.beginPath(),c.arc(250,250,2,0,2*Math.PI),c.fill(),M.reset(),console.log("starting..."),V()},setInterval((()=>q.innerText="fps "+Math.floor(1e3/K)),100);let U=!1;function V(){const t=(d.s?-1:0)+(d.w?1:0),e=(d.d?-1:0)+(d.a?1:0);p.x+=e,p.y+=t,Q(U?N:V)}document.addEventListener("keydown",(({key:t})=>{" "!==t||U||(U=!0)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zd2FybS1zaW11bGF0b3Ivd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc3dhcm0tc2ltdWxhdG9yL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9zd2FybS1zaW11bGF0b3Ivd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9zd2FybS1zaW11bGF0b3Ivd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly9zd2FybS1zaW11bGF0b3IvLi9zcmMvdXRpbC9tZW1vcnkudHMiLCJ3ZWJwYWNrOi8vc3dhcm0tc2ltdWxhdG9yLy4vc3JjL3V0aWwvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vc3dhcm0tc2ltdWxhdG9yLy4vc3JjL3N0b3JlL2NhbnZhcy50cyIsIndlYnBhY2s6Ly9zd2FybS1zaW11bGF0b3IvLi9zcmMvb2JzdGFjbGUvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vc3dhcm0tc2ltdWxhdG9yLy4vc3JjL3N0b3JlL29ic3RhY2xlcy50cyIsIndlYnBhY2s6Ly9zd2FybS1zaW11bGF0b3IvLi9zcmMvc3RvcmUvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vc3dhcm0tc2ltdWxhdG9yLy4vc3JjL21hcC9pbmRleC50cyIsIndlYnBhY2s6Ly9zd2FybS1zaW11bGF0b3IvLi9zcmMvcGxheWVyL3JheS50cyIsIndlYnBhY2s6Ly9zd2FybS1zaW11bGF0b3IvLi9zcmMvcGF0aGZpbmRlci9hLXN0YXIvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vc3dhcm0tc2ltdWxhdG9yLy4vc3JjL2RyYXcvcGxheWVyLnRzIiwid2VicGFjazovL3N3YXJtLXNpbXVsYXRvci8uL3NyYy9wbGF5ZXIvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vc3dhcm0tc2ltdWxhdG9yLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL3N3YXJtLXNpbXVsYXRvci8uL3NyYy9kcmF3L21hcC50cyJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJNZW1vcnlDaGFuZ2VMaXN0IiwidGhpcyIsIm1lbW9yeSIsIk1hcCIsInJvdyIsImNvbCIsImhhcyIsInNldCIsIkFycmF5IiwiZnJvbSIsImtleXMiLCJkZWxldGUiLCJzdXBlciIsImNoYW5nZXMiLCJwdXNoIiwiZmFjdG9yIiwiTWF0aCIsIlBJIiwiY29zIiwiZGVncmVlcyIsInNpbiIsImFzeW5jIiwic2xlZXAiLCJ0aW1lIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwicmFuZEludCIsIm1pbiIsIm1heCIsImZsb29yIiwicmFuZG9tIiwibWFwQmFja2dyb3VuZENhbnZhcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRDb250ZXh0IiwiaW1hZ2VTbW9vdGhpbmdFbmFibGVkIiwibWFwTWFpbkNhbnZhcyIsInBsYXllck1haW5DYW52YXMiLCJwbGF5ZXJQYXRoQ2FudmFzIiwia2V5Ym9hcmQiLCJ3IiwiYSIsInMiLCJkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIk9ic3RhY2xlIiwieCIsInkiLCJsZW5ndGgiLCJkaXIiLCJyeCIsInJ5Iiwicm91bmQiLCJvYnN0YWNsZXMiLCJhc3NpZ24iLCJpIiwibiIsInVwZGF0ZSIsIm1hemUiLCJJbWFnZSIsInNyYyIsIndpZHRoIiwiaGVpZ2h0Iiwic3RhcnQiLCJtYXAiLCJmaWxsIiwiZGF0YSIsInJlc2V0IiwiciIsImMiLCJmaWx0ZXIiLCJ2IiwiUmF5IiwiaW50ZWdyYWxzIiwiZHgiLCJkeSIsImdvYWwiLCJweCIsInB5IiwibXgiLCJteSIsImFicyIsInN4Iiwic3kiLCJlcnIiLCJjb29yZGluYXRlcyIsInVuZGVmaW5lZCIsImUyIiwicmF5SW50ZWdyYWxzIiwic3FydCIsImluaXQiLCJwbGF5ZXIiLCJlbmQiLCJkZyIsImRpc3QiLCJkcyIsImNvc3QiLCJyZXNldENoYW5nZXMiLCJjb21wdXRlIiwic29ydCIsIm1heENvc3QiLCJwYXJlbnQiLCJwb3AiLCJwZHMiLCJub2RlIiwiZ2V0UGF0aCIsIm9wZW5Db250YWlucyIsImIiLCJwYXRoIiwicGxheWVyTWFpbkltYWdlRGF0YSIsImNyZWF0ZUltYWdlRGF0YSIsInBsYXllclBhdGhJbWFnZURhdGEiLCJkcmF3UGxheWVyUGF0aCIsIm5vZGVzIiwicCIsInB1dEltYWdlRGF0YSIsInJheXMiLCJnb2FsRGlyZWN0aW9ucyIsInBhdGhmaW5kZXIiLCJsMXgxIiwibDF5MSIsImwxZGlyIiwibDF4MiIsImExIiwiYjEiLCJjMSIsImwyeDEiLCJsMnkxIiwibDJkaXIiLCJsMngyIiwiYTIiLCJiMiIsImMyIiwiY3giLCJjeSIsImV4IiwiZXkiLCJ0aGV0YSIsImF0YW4yIiwiZmluZEdvYWwiLCJjb21wdXRlUGF0aCIsInJheSIsImNvbGxpZGUiLCJwb2ludCIsImoiLCJ0aW1lciIsInBlcmZvcm1hbmNlIiwibm93IiwiZnBzRGlzcGxheSIsInBvc0Rpc3BsYXkiLCJhY3R1YWxQb3NEaXNwbGF5IiwiZ29hbEVzdGltYXRlRGlzcGxheSIsInQiLCJkcmF3IiwibmV4dCIsImNsZWFyUmVjdCIsInN0cm9rZVN0eWxlIiwiaW50IiwiYmVnaW5QYXRoIiwibW92ZVRvIiwibGluZVRvIiwic3Ryb2tlIiwiZmlsbFN0eWxlIiwiZm9yRWFjaCIsImZpbGxSZWN0IiwiYXJjIiwiZHJhd01hcCIsImRyYXdQbGF5ZXIiLCJpbm5lclRleHQiLCJ3aW5kb3ciLCJvbmxvYWQiLCJjb25zb2xlIiwibG9nIiwiZHJhd0ltYWdlIiwiZ2V0SW1hZ2VEYXRhIiwic2V0SW50ZXJ2YWwiLCJiZWdpbiJdLCJtYXBwaW5ncyI6Im1CQUNB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IF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImV4cG9ydCBjbGFzcyBNZW1vcnkge1xuICAgIHByb3RlY3RlZCBtZW1vcnk6IE1hcDxudW1iZXIsIE1hcDxudW1iZXIsIG51bWJlcj4+O1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMubWVtb3J5ID0gbmV3IE1hcCgpO1xuICAgIH1cblxuICAgIGdldChyb3c6IG51bWJlciwgY29sOiBudW1iZXIpOiBudW1iZXIgfCB1bmRlZmluZWQge1xuICAgICAgICByZXR1cm4gdGhpcy5tZW1vcnkuZ2V0KHJvdyk/LmdldChjb2wpO1xuICAgIH1cblxuICAgIHNldChyb3c6IG51bWJlciwgY29sOiBudW1iZXIsIHZhbHVlOiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBtZW1vcnkgfSA9IHRoaXM7XG5cbiAgICAgICAgaWYgKCFtZW1vcnkuaGFzKHJvdykpIG1lbW9yeS5zZXQocm93LCBuZXcgTWFwKCkpO1xuXG4gICAgICAgIG1lbW9yeS5nZXQocm93KSEuc2V0KGNvbCwgdmFsdWUpO1xuICAgIH1cblxuICAgIHJvd3MoKTogbnVtYmVyW10ge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLm1lbW9yeS5rZXlzKCkpO1xuICAgIH1cblxuICAgIGNvbHMocm93OiBudW1iZXIpOiBudW1iZXJbXSB7XG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMubWVtb3J5LmdldChyb3cpPy5rZXlzKCkgfHwgW10pO1xuICAgIH1cblxuICAgIGRlbChyb3c6IG51bWJlciwgY29sOiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5tZW1vcnkuZ2V0KHJvdyk/LmRlbGV0ZShjb2wpO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIE1lbW9yeUNoYW5nZUxpc3QgZXh0ZW5kcyBNZW1vcnkge1xuICAgIGNoYW5nZXM6IHsgcm93OiBudW1iZXI7IGNvbDogbnVtYmVyOyB2YWx1ZTogbnVtYmVyIH1bXSA9IFtdO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgfVxuXG4gICAgZ2V0KHJvdzogbnVtYmVyLCBjb2w6IG51bWJlcik6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lbW9yeS5nZXQocm93KT8uZ2V0KGNvbCk7XG4gICAgfVxuXG4gICAgc2V0KHJvdzogbnVtYmVyLCBjb2w6IG51bWJlciwgdmFsdWU6IG51bWJlcik6IHZvaWQge1xuICAgICAgICBjb25zdCB7IG1lbW9yeSwgY2hhbmdlcyB9ID0gdGhpcztcblxuICAgICAgICBpZiAoIW1lbW9yeS5oYXMocm93KSkgbWVtb3J5LnNldChyb3csIG5ldyBNYXAoKSk7XG5cbiAgICAgICAgbWVtb3J5LmdldChyb3cpIS5zZXQoY29sLCB2YWx1ZSk7XG4gICAgICAgIGNoYW5nZXMucHVzaCh7IHJvdywgY29sLCB2YWx1ZSB9KTtcbiAgICB9XG5cbiAgICByb3dzKCk6IG51bWJlcltdIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5tZW1vcnkua2V5cygpKTtcbiAgICB9XG5cbiAgICBjb2xzKHJvdzogbnVtYmVyKTogbnVtYmVyW10ge1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLm1lbW9yeS5nZXQocm93KT8ua2V5cygpIHx8IFtdKTtcbiAgICB9XG5cbiAgICBkZWwocm93OiBudW1iZXIsIGNvbDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMubWVtb3J5LmdldChyb3cpPy5kZWxldGUoY29sKTtcbiAgICB9XG5cbiAgICByZXNldCgpOiB2b2lkIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5jaGFuZ2VzLmxlbmd0aCk7XG4gICAgICAgIHRoaXMuY2hhbmdlcyA9IFtdO1xuICAgIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBUaW1lciB7XG4gICAgcHJpdmF0ZSB0aW1lID0gMDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnN0YXJ0KCk7XG4gICAgfVxuXG4gICAgc3RhcnQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMudGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgIH1cblxuICAgIGVuZCgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gcGVyZm9ybWFuY2Uubm93KCkgLSB0aGlzLnRpbWU7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaW50ZWdyYWxzKFxuICAgIHgwOiBudW1iZXIsXG4gICAgeTA6IG51bWJlcixcbiAgICB4MTogbnVtYmVyLFxuICAgIHkxOiBudW1iZXJcbik6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfVtdIHtcbiAgICBjb25zdCBkeCA9IE1hdGguYWJzKHgxIC0geDApO1xuICAgIGNvbnN0IGR5ID0gTWF0aC5hYnMoeTEgLSB5MCk7XG4gICAgY29uc3Qgc3ggPSB4MCA8IHgxID8gMSA6IC0xO1xuICAgIGNvbnN0IHN5ID0geTAgPCB5MSA/IDEgOiAtMTtcbiAgICBsZXQgZXJyID0gZHggLSBkeTtcblxuICAgIGNvbnN0IGNvb3JkaW5hdGVzID0gW107XG5cbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICBjb29yZGluYXRlcy5wdXNoKHsgeDogeDAsIHk6IHkwIH0pO1xuXG4gICAgICAgIGlmICh4MCA9PT0geDEgJiYgeTAgPT09IHkxKSByZXR1cm4gY29vcmRpbmF0ZXM7XG4gICAgICAgIGNvbnN0IGUyID0gMiAqIGVycjtcbiAgICAgICAgaWYgKGUyID4gLWR5KSB7XG4gICAgICAgICAgICBlcnIgLT0gZHk7XG4gICAgICAgICAgICB4MCArPSBzeDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZTIgPCBkeCkge1xuICAgICAgICAgICAgZXJyICs9IGR4O1xuICAgICAgICAgICAgeTAgKz0gc3k7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmNvbnN0IGZhY3RvciA9IE1hdGguUEkgLyAxODA7XG5cbmV4cG9ydCBmdW5jdGlvbiBjb3MoZGVncmVlczogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5jb3MoZGVncmVlcyAqIGZhY3Rvcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaW4oZGVncmVlczogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5zaW4oZGVncmVlcyAqIGZhY3Rvcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkaXIoY3g6IG51bWJlciwgY3k6IG51bWJlciwgZXg6IG51bWJlciwgZXk6IG51bWJlcik6IG51bWJlciB7XG4gICAgY29uc3QgZHggPSBjeCAtIGV4O1xuICAgIGNvbnN0IGR5ID0gY3kgLSBleTtcblxuICAgIGNvbnN0IHRoZXRhID0gKE1hdGguYXRhbjIoLWR5LCAtZHgpICogMTgwKSAvIE1hdGguUEk7XG5cbiAgICByZXR1cm4gdGhldGEgPCAwID8gdGhldGEgKyAzNjAgOiB0aGV0YTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNsZWVwKHRpbWUgPSAwKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIHRpbWUpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJhbmRJbnQobWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpICsgbWluKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcm91bmQobjogbnVtYmVyLCBkID0gMik6IG51bWJlciB7XG4gICAgcmV0dXJuICtuLnRvRml4ZWQoZCk7XG59XG5cbmV4cG9ydCAqIGZyb20gJy4vbWVtb3J5JztcbiIsImV4cG9ydCBjb25zdCBtYXBCYWNrZ3JvdW5kQ2FudmFzID0gKFxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtYmFja2dyb3VuZC1sYXllcicpIGFzIEhUTUxDYW52YXNFbGVtZW50XG4pLmdldENvbnRleHQoJzJkJykhO1xubWFwQmFja2dyb3VuZENhbnZhcy5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTtcblxuZXhwb3J0IGNvbnN0IG1hcE1haW5DYW52YXMgPSAoXG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1tYWluLWxheWVyJykgYXMgSFRNTENhbnZhc0VsZW1lbnRcbikuZ2V0Q29udGV4dCgnMmQnKSE7XG5tYXBNYWluQ2FudmFzLmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IGZhbHNlO1xuXG5leHBvcnQgY29uc3QgcGxheWVyTWFpbkNhbnZhcyA9IChcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheWVyLW1haW4tbGF5ZXInKSBhcyBIVE1MQ2FudmFzRWxlbWVudFxuKS5nZXRDb250ZXh0KCcyZCcpITtcbnBsYXllck1haW5DYW52YXMuaW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7XG5cbmV4cG9ydCBjb25zdCBwbGF5ZXJQYXRoQ2FudmFzID0gKFxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF5ZXItcGF0aC1sYXllcicpIGFzIEhUTUxDYW52YXNFbGVtZW50XG4pLmdldENvbnRleHQoJzJkJykhO1xucGxheWVyUGF0aENhbnZhcy5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTtcblxuZXhwb3J0IGNvbnN0IGtleWJvYXJkID0ge1xuICAgIHc6IGZhbHNlLFxuICAgIGE6IGZhbHNlLFxuICAgIHM6IGZhbHNlLFxuICAgIGQ6IGZhbHNlLFxufTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsICh7IGtleSB9KSA9PiB7XG4gICAgc3dpdGNoIChrZXkpIHtcbiAgICAgICAgY2FzZSAndyc6XG4gICAgICAgICAgICBrZXlib2FyZC53ID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdhJzpcbiAgICAgICAgICAgIGtleWJvYXJkLmEgPSB0cnVlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3MnOlxuICAgICAgICAgICAga2V5Ym9hcmQucyA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZCc6XG4gICAgICAgICAgICBrZXlib2FyZC5kID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn0pO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsICh7IGtleSB9KSA9PiB7XG4gICAgc3dpdGNoIChrZXkpIHtcbiAgICAgICAgY2FzZSAndyc6XG4gICAgICAgICAgICBrZXlib2FyZC53ID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnYSc6XG4gICAgICAgICAgICBrZXlib2FyZC5hID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAncyc6XG4gICAgICAgICAgICBrZXlib2FyZC5zID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZCc6XG4gICAgICAgICAgICBrZXlib2FyZC5kID0gZmFsc2U7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG59KTtcbiIsImltcG9ydCB7IGNvcywgc2luIH0gZnJvbSAnLi4vdXRpbCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9ic3RhY2xlIHtcbiAgICB4OiBudW1iZXI7XG4gICAgeTogbnVtYmVyO1xuICAgIHByaXZhdGUgZGlyOiBudW1iZXI7XG4gICAgcHJpdmF0ZSByZWFkb25seSByeDogbnVtYmVyO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgcnk6IG51bWJlcjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGxlbmd0aDogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IoeCA9IDI1MCwgeSA9IDI1MCwgbGVuZ3RoID0gMzAsIGRpciA9IDApIHtcbiAgICAgICAgdGhpcy54ID0geCArIGxlbmd0aDtcbiAgICAgICAgdGhpcy55ID0geSArIGxlbmd0aDtcbiAgICAgICAgdGhpcy5yeCA9IHg7XG4gICAgICAgIHRoaXMucnkgPSB5O1xuICAgICAgICB0aGlzLmRpciA9IGRpcjtcbiAgICAgICAgdGhpcy5sZW5ndGggPSBsZW5ndGg7XG4gICAgfVxuXG4gICAgdXBkYXRlKCk6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSB7XG4gICAgICAgIHRoaXMuZGlyKys7XG4gICAgICAgIGlmICh0aGlzLmRpciA+PSAzNjApIHRoaXMuZGlyID0gMDtcblxuICAgICAgICBjb25zdCB7IGRpciB9ID0gdGhpcztcblxuICAgICAgICBjb25zdCB4ID0gdGhpcy5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHkgPSAwO1xuXG4gICAgICAgIHRoaXMueCA9IHRoaXMucnggKyBNYXRoLnJvdW5kKHggKiBjb3MoZGlyKSAtIHkgKiBzaW4oZGlyKSk7XG4gICAgICAgIHRoaXMueSA9IHRoaXMucnkgKyBNYXRoLnJvdW5kKHggKiBzaW4oZGlyKSArIHkgKiBjb3MoZGlyKSk7XG5cbiAgICAgICAgcmV0dXJuIHsgeDogdGhpcy54LCB5OiB0aGlzLnkgfTtcbiAgICB9XG59XG4iLCJpbXBvcnQgT2JzdGFjbGUgZnJvbSAnLi4vb2JzdGFjbGUnO1xuXG5pbnRlcmZhY2UgT2JzdGFjbGVzIGV4dGVuZHMgQXJyYXk8T2JzdGFjbGU+IHtcbiAgICB1cGRhdGUoKTogdm9pZDtcbn1cblxuZXhwb3J0IGNvbnN0IG9ic3RhY2xlczogT2JzdGFjbGVzID0gT2JqZWN0LmFzc2lnbihbXSwge1xuICAgIHVwZGF0ZSgpOiB2b2lkIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIG4gPSBvYnN0YWNsZXMubGVuZ3RoOyBpIDwgbjsgaSsrKSBvYnN0YWNsZXNbaV0udXBkYXRlKCk7XG4gICAgfSxcbn0pO1xuZm9yIChsZXQgaSA9IDMwOyBpIDwgNTA7IGkrKykgb2JzdGFjbGVzLnB1c2gobmV3IE9ic3RhY2xlKDI1MCwgMjUwLCBpKSk7XG4iLCJleHBvcnQgY29uc3QgbWF6ZSA9IG5ldyBJbWFnZSgpO1xubWF6ZS5zcmMgPSAnYXNzZXRzL21hemUucG5nJztcblxuZXhwb3J0IGNvbnN0IHdpZHRoID0gbWF6ZS53aWR0aDtcbmV4cG9ydCBjb25zdCBoZWlnaHQgPSBtYXplLmhlaWdodDtcblxuZXhwb3J0IGNvbnN0IHN0YXJ0ID0ge1xuICAgIHg6IDEwMCxcbiAgICB5OiAxMDAsXG59XG5cbmV4cG9ydCBjb25zdCBnb2FsID0ge1xuICAgIHg6IDI1MCxcbiAgICB5OiAyNTAsXG59O1xuXG5leHBvcnQgKiBmcm9tICcuL2NhbnZhcyc7XG5cbmV4cG9ydCAqIGZyb20gJy4vb2JzdGFjbGVzJztcbiIsImltcG9ydCB7IGdvYWwsIGhlaWdodCwgb2JzdGFjbGVzLCB3aWR0aCB9IGZyb20gJy4uL3N0b3JlJztcblxuaW50ZXJmYWNlIFZpZXcgZXh0ZW5kcyBBcnJheTxBcnJheTxudW1iZXI+PiB7XG4gICAgZGF0YTogbnVtYmVyW107XG5cbiAgICBkaXI6IG51bWJlcjtcblxuICAgIHJlc2V0KCk6IHZvaWQ7XG5cbiAgICBzZXQoZGF0YTogVWludDhDbGFtcGVkQXJyYXkpOiB2b2lkO1xufVxuXG5jb25zdCBtYXA6IFZpZXcgPSBPYmplY3QuYXNzaWduKFxuICAgIG5ldyBBcnJheShoZWlnaHQpLmZpbGwoMCkubWFwKCgpID0+IG5ldyBBcnJheSh3aWR0aCkuZmlsbCgwKSksXG4gICAge1xuICAgICAgICBkYXRhOiBbXSBhcyBudW1iZXJbXSxcbiAgICAgICAgZGlyOiAwLFxuICAgICAgICByZXNldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc3QgeyBkYXRhIH0gPSB0aGlzO1xuXG4gICAgICAgICAgICAvLyBTdGF0aWMgb2JzdGFjbGVzXG4gICAgICAgICAgICBmb3IgKGxldCByID0gMCwgbiA9IGhlaWdodDsgciA8IG47IHIrKykge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGMgPSAwLCBuID0gd2lkdGg7IGMgPCBuOyBjKyspIG1hcFtyXVtjXSA9ICshZGF0YVtyICogd2lkdGggKyBjXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gRHluYW1pYyBvYnN0YWNsZXNcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBuID0gb2JzdGFjbGVzLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgeCwgeSB9ID0gb2JzdGFjbGVzW2ldO1xuICAgICAgICAgICAgICAgIG1hcFt5XVt4XSA9IDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEdvYWwgaW4gbWFwXG4gICAgICAgICAgICBtYXBbZ29hbC55XVtnb2FsLnhdID0gMTAwO1xuICAgICAgICB9LFxuICAgICAgICBzZXQoZGF0YTogVWludDhDbGFtcGVkQXJyYXkpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IEFycmF5LmZyb20oZGF0YS5maWx0ZXIoKHYsIGkpID0+IGkgJSA0ID09PSAwKSk7XG4gICAgICAgIH0sXG4gICAgfVxuKTtcblxuZXhwb3J0IGRlZmF1bHQgbWFwO1xuIiwiaW1wb3J0IG1hcCBmcm9tICcuLi9tYXAnO1xuaW1wb3J0IHsgY29zLCBzaW4gfSBmcm9tICcuLi91dGlsJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmF5IHtcbiAgICByZWFkb25seSBkaXI6IG51bWJlcjtcbiAgICBpbnRlZ3JhbHM6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfVtdID0gW107XG4gICAgcHJpdmF0ZSByZWFkb25seSBkeDogbnVtYmVyO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgZHk6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKGRpcjogbnVtYmVyLCBsZW5ndGggPSAxMDApIHtcbiAgICAgICAgdGhpcy5kaXIgPSBkaXI7XG4gICAgICAgIGNvbnN0IHggPSBsZW5ndGg7XG4gICAgICAgIGNvbnN0IHkgPSAwO1xuXG4gICAgICAgIHRoaXMuZHggPSBNYXRoLnJvdW5kKHggKiBjb3MoZGlyKSAtIHkgKiBzaW4oZGlyKSk7XG4gICAgICAgIHRoaXMuZHkgPSBNYXRoLnJvdW5kKHggKiBzaW4oZGlyKSArIHkgKiBjb3MoZGlyKSk7XG4gICAgfVxuXG4gICAgLy8gRW1wdHkgcG9pbnRzOyBDb2xsaXNpb24gcG9pbnRcbiAgICB1cGRhdGUoeDogbnVtYmVyLCB5OiBudW1iZXIpOiBbYm9vbGVhbiwgeyB4OiBudW1iZXI7IHk6IG51bWJlciB9PywgeyB4OiBudW1iZXI7IHk6IG51bWJlciB9P10ge1xuICAgICAgICBjb25zdCBbaW50ZWdyYWxzLCBjb2wsIGdvYWxdID0gcmF5SW50ZWdyYWxzKHgsIHksIHggKyB0aGlzLmR4LCB5ICsgdGhpcy5keSk7XG4gICAgICAgIHRoaXMuaW50ZWdyYWxzID0gaW50ZWdyYWxzO1xuXG4gICAgICAgIHJldHVybiBbaW50ZWdyYWxzLmxlbmd0aCA9PT0gMCwgY29sLCBnb2FsXTtcbiAgICB9XG59XG5cbi8vIEVtcHR5IHBvaW50czsgQ29sbGlzaW9uIHBvaW50OyBHb2FsXG5mdW5jdGlvbiByYXlJbnRlZ3JhbHMoXG4gICAgcHg6IG51bWJlcixcbiAgICBweTogbnVtYmVyLFxuICAgIG14OiBudW1iZXIsXG4gICAgbXk6IG51bWJlclxuKTogW3sgeDogbnVtYmVyOyB5OiBudW1iZXIgfVtdLCB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0/LCB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0/XSB7XG4gICAgY29uc3QgZHggPSBNYXRoLmFicyhteCAtIHB4KTtcbiAgICBjb25zdCBkeSA9IE1hdGguYWJzKG15IC0gcHkpO1xuICAgIGNvbnN0IHN4ID0gcHggPCBteCA/IDEgOiAtMTtcbiAgICBjb25zdCBzeSA9IHB5IDwgbXkgPyAxIDogLTE7XG4gICAgbGV0IGVyciA9IGR4IC0gZHk7XG5cbiAgICBjb25zdCBjb29yZGluYXRlcyA9IFtdO1xuXG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgY29uc3Qgcm93ID0gbWFwW3B5XTtcbiAgICAgICAgY29uc3QgY29sID0gcm93Py5bcHhdO1xuXG4gICAgICAgIC8vIFRlcm1pbmF0ZSBvbiBnb2FsIGZvdW5kXG4gICAgICAgIGlmIChjb2wgPT09IDEwMCkgcmV0dXJuIFtjb29yZGluYXRlcywgdW5kZWZpbmVkLCB7IHg6IHB4LCB5OiBweSB9XTtcblxuICAgICAgICAvKiBUZXJtaW5hdGUgb246XG4gICAgICAgIFJvdyBvdXQgb2YgYm91bmRzXG4gICAgICAgIENvbCBvdXQgb2YgYm91bmRzXG4gICAgICAgIENvbCBpcyB3YWxsXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoY29sID09PSB1bmRlZmluZWQgfHwgY29sID09PSAxKSByZXR1cm4gW2Nvb3JkaW5hdGVzLCB7IHg6IHB4LCB5OiBweSB9LCB1bmRlZmluZWRdO1xuXG4gICAgICAgIC8vIFRlcm1pbmF0ZSBvbiBtYXggbGVuZ3RoIHJlYWNoZWQ7IE5vIGNvbGxpc2lvblxuICAgICAgICBpZiAocHggPT09IG14ICYmIHB5ID09PSBteSkgcmV0dXJuIFtjb29yZGluYXRlcywgdW5kZWZpbmVkXTtcblxuICAgICAgICBjb29yZGluYXRlcy5wdXNoKHsgeDogcHgsIHk6IHB5IH0pO1xuICAgICAgICBjb25zdCBlMiA9IDIgKiBlcnI7XG4gICAgICAgIGlmIChlMiA+IC1keSkge1xuICAgICAgICAgICAgZXJyIC09IGR5O1xuICAgICAgICAgICAgcHggKz0gc3g7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUyIDwgZHgpIHtcbiAgICAgICAgICAgIGVyciArPSBkeDtcbiAgICAgICAgICAgIHB5ICs9IHN5O1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgTWVtb3J5Q2hhbmdlTGlzdCB9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHsgUGxheWVyIH0gZnJvbSAnLi4vLi4vcGxheWVyJztcblxudHlwZSBOb2RlID0ge1xuICAgIHg6IG51bWJlcjtcbiAgICB5OiBudW1iZXI7XG4gICAgZHM6IG51bWJlcjtcbiAgICBkZzogbnVtYmVyO1xuICAgIGNvc3Q6IG51bWJlcjtcbiAgICBwYXJlbnQ/OiBOb2RlO1xufTtcblxuY29uc3QgeyBzcXJ0IH0gPSBNYXRoO1xuXG5sZXQgZ29hbDogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9O1xubGV0IG9wZW46IE5vZGVbXTtcbmxldCBtZW1vcnk6IE1lbW9yeUNoYW5nZUxpc3Q7XG5sZXQgY2xvc2VkOiBNZW1vcnlDaGFuZ2VMaXN0O1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdChwbGF5ZXI6IFBsYXllciwgZW5kOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0pOiB2b2lkIHtcbiAgICBvcGVuID0gW107XG4gICAgZ29hbCA9IGVuZDtcbiAgICBtZW1vcnkgPSBwbGF5ZXIubWVtb3J5O1xuICAgIGNsb3NlZCA9IG5ldyBNZW1vcnlDaGFuZ2VMaXN0KCk7XG5cbiAgICAvLyBjb25zb2xlLmxvZyhvcGVuLCBnb2FsLCBtZW1vcnksIGNsb3NlZCk7XG5cbiAgICBjb25zdCB7IHgsIHkgfSA9IHBsYXllcjtcblxuICAgIGNvbnN0IGRnID0gZGlzdCh7IHgsIHkgfSwgZ29hbCk7XG4gICAgb3Blbi5wdXNoKHtcbiAgICAgICAgeCxcbiAgICAgICAgeSxcbiAgICAgICAgZHM6IDAsXG4gICAgICAgIGRnLFxuICAgICAgICBjb3N0OiBkZyxcbiAgICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoYW5nZXMoKTogeyByb3c6IG51bWJlcjsgY29sOiBudW1iZXI7IHZhbHVlOiBudW1iZXIgfVtdIHtcbiAgICByZXR1cm4gY2xvc2VkLmNoYW5nZXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNldENoYW5nZXMoKTogdm9pZCB7XG4gICAgY2xvc2VkLnJlc2V0KCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb21wdXRlKCk6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfVtdIHwgdW5kZWZpbmVkIHtcbiAgICBvcGVuLnNvcnQobWF4Q29zdCk7XG4gICAgY29uc3QgcGFyZW50ID0gb3Blbi5wb3AoKSE7XG5cbiAgICBjb25zdCB7IHg6IHB4LCB5OiBweSwgZHM6IHBkcyB9ID0gcGFyZW50O1xuXG4gICAgY2xvc2VkLnNldChweSwgcHgsIDEpO1xuXG4gICAgLy8geSAtIDEgdG8geSArIDFcbiAgICBmb3IgKGxldCB5ID0gcHkgKyAyOyAtLXkgPj0gcHkgLSAxOyApIHtcbiAgICAgICAgLy8geCAtIDEgdG8geCArIDFcbiAgICAgICAgZm9yIChsZXQgeCA9IHB4ICsgMjsgLS14ID49IHB4IC0gMTsgKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlID0geyB4LCB5LCBwYXJlbnQgfTtcblxuICAgICAgICAgICAgY29uc3QgY29sID0gbWVtb3J5LmdldCh5LCB4KTtcblxuICAgICAgICAgICAgLy8gR29hbCBmb3VuZFxuICAgICAgICAgICAgaWYgKHggPT09IGdvYWwueCAmJiB5ID09PSBnb2FsLnkpIHJldHVybiBnZXRQYXRoKG5vZGUsIFtdKTtcblxuICAgICAgICAgICAgLy8gT2JzdGFjbGUgb3IgUG9pbnQgYWxyZWFkeSBleHBhbmRlZFxuICAgICAgICAgICAgaWYgKGNvbCA9PT0gMiB8fCBjbG9zZWQuZ2V0KHksIHgpID09PSAxKSBjb250aW51ZTtcblxuICAgICAgICAgICAgLy8gd2VpZ2h0ZWRcbiAgICAgICAgICAgIGNvbnN0IGRzID0gcGRzICogMC45NSArIGRpc3Qobm9kZSwgcGFyZW50KTtcbiAgICAgICAgICAgIGNvbnN0IGRnID0gZGlzdChub2RlLCBnb2FsKTtcbiAgICAgICAgICAgIGNvbnN0IGNvc3QgPSBkcyArIGRnO1xuXG4gICAgICAgICAgICBjb25zdCBvID0gb3BlbkNvbnRhaW5zKG5vZGUpO1xuXG4gICAgICAgICAgICBpZiAobykge1xuICAgICAgICAgICAgICAgIGlmIChvLmNvc3QgPiBjb3N0KSB7XG4gICAgICAgICAgICAgICAgICAgIG8uY29zdCA9IGNvc3Q7XG4gICAgICAgICAgICAgICAgICAgIG8uZHMgPSBkcztcbiAgICAgICAgICAgICAgICAgICAgby5kZyA9IGRnO1xuICAgICAgICAgICAgICAgICAgICBvLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG9wZW4ucHVzaCh7IC4uLm5vZGUsIGNvc3QsIGRzLCBkZyB9KTtcbiAgICAgICAgICAgICAgICAvLyBtYXBbeV1beF0gPSAyMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRpc3QoYTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9LCBiOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0pOiBudW1iZXIge1xuICAgIGNvbnN0IGR4ID0gYS54IC0gYi54O1xuICAgIGNvbnN0IGR5ID0gYS55IC0gYi55O1xuICAgIHJldHVybiBzcXJ0KGR4ICogZHggKyBkeSAqIGR5KTtcbn1cblxuZnVuY3Rpb24gbWF4Q29zdChhOiBOb2RlLCBiOiBOb2RlKTogbnVtYmVyIHtcbiAgICAvLyByZXR1cm4gYS5jb3N0IC0gYi5jb3N0IHx8IGEuZGcgLSBiLmRnOyAvLyBtaW4gY29zdFxuICAgIHJldHVybiBiLmNvc3QgLSBhLmNvc3QgfHwgYi5kZyAtIGEuZGc7XG59XG5cbmZ1bmN0aW9uIGdldFBhdGgoXG4gICAgbm9kZTogeyB4OiBudW1iZXI7IHk6IG51bWJlcjsgcGFyZW50PzogTm9kZSB9LFxuICAgIHBhdGg6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfVtdXG4pOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH1bXSB7XG4gICAgcGF0aC5wdXNoKG5vZGUpO1xuICAgIGNvbnN0IHsgcGFyZW50IH0gPSBub2RlO1xuICAgIHJldHVybiBwYXJlbnQgPyBnZXRQYXRoKHBhcmVudCwgcGF0aCkgOiBwYXRoO1xufVxuXG5mdW5jdGlvbiBvcGVuQ29udGFpbnMobm9kZTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9KTogTm9kZSB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgeyB4LCB5IH0gPSBub2RlO1xuXG4gICAgLy8gZm9yIChsZXQgaSA9IDAsIG4gPSBvcGVuLmxlbmd0aDsgaSA8IG47IGkrKykge1xuICAgIGZvciAobGV0IGkgPSBvcGVuLmxlbmd0aDsgLS1pID49IDA7ICkge1xuICAgICAgICBjb25zdCBub2RlID0gb3BlbltpXTtcbiAgICAgICAgaWYgKHggPT09IG5vZGUueCAmJiB5ID09PSBub2RlLnkpIHJldHVybiBub2RlO1xuICAgIH1cbn1cbiIsImltcG9ydCBwbGF5ZXIgZnJvbSAnLi4vcGxheWVyJztcbmltcG9ydCB7IGNoYW5nZXMsIHJlc2V0Q2hhbmdlcyB9IGZyb20gJy4uL3BhdGhmaW5kZXIvYS1zdGFyJztcbmltcG9ydCB7XG4gICAgaGVpZ2h0LFxuICAgIHBsYXllck1haW5DYW52YXMsXG4gICAgcGxheWVyUGF0aENhbnZhcyxcbiAgICBzdGFydCxcbiAgICB3aWR0aCxcbn0gZnJvbSAnLi4vc3RvcmUnO1xuXG5jb25zdCBwbGF5ZXJNYWluSW1hZ2VEYXRhID0gcGxheWVyTWFpbkNhbnZhcy5jcmVhdGVJbWFnZURhdGEod2lkdGggKyAyLCBoZWlnaHQgKyAyKTtcbmxldCBwbGF5ZXJQYXRoSW1hZ2VEYXRhID0gcGxheWVyUGF0aENhbnZhcy5jcmVhdGVJbWFnZURhdGEod2lkdGggKyAyLCBoZWlnaHQgKyAyKTtcbmNvbnN0IHcgPSAod2lkdGggKyAyKSAqIDQ7XG5cbmV4cG9ydCBmdW5jdGlvbiBkcmF3UGxheWVyKCk6IHZvaWQge1xuICAgIGNvbnN0IGR5ID0gc3RhcnQueSArIDE7XG4gICAgY29uc3QgZHggPSBzdGFydC54ICsgMTtcbiAgICBjb25zdCB7IGNoYW5nZXMgfSA9IHBsYXllci5tZW1vcnk7XG4gICAgY29uc3QgeyBkYXRhIH0gPSBwbGF5ZXJNYWluSW1hZ2VEYXRhO1xuXG4gICAgbGV0IGdvYWw6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSB8IHVuZGVmaW5lZDtcblxuICAgIGZvciAobGV0IGkgPSAwLCBuID0gY2hhbmdlcy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgY29uc3QgeyByb3csIGNvbCwgdmFsdWUgfSA9IGNoYW5nZXNbaV07XG4gICAgICAgIGNvbnN0IHAgPSAocm93ICsgZHkpICogdyArIChjb2wgKyBkeCkgKiA0O1xuXG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAvLyBFbXB0eSBwb2ludFxuICAgICAgICAgICAgICAgIGRhdGFbcF0gPSA1MDtcbiAgICAgICAgICAgICAgICBkYXRhW3AgKyAxXSA9IDIwNTtcbiAgICAgICAgICAgICAgICBkYXRhW3AgKyAyXSA9IDUwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIC8vIE9ic3RhY2xlXG4gICAgICAgICAgICAgICAgZGF0YVtwXSA9IDA7XG4gICAgICAgICAgICAgICAgZGF0YVtwICsgMV0gPSAwO1xuICAgICAgICAgICAgICAgIGRhdGFbcCArIDJdID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAvLyBHb2FsXG4gICAgICAgICAgICAgICAgZGF0YVtwXSA9IDA7XG4gICAgICAgICAgICAgICAgZGF0YVtwICsgMV0gPSAwO1xuICAgICAgICAgICAgICAgIGRhdGFbcCArIDJdID0gMjU1O1xuICAgICAgICAgICAgICAgIGdvYWwgPSB7IHg6IGNvbCwgeTogcm93IH07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBkYXRhW3AgKyAzXSA9IDI1NTtcbiAgICB9XG4gICAgcGxheWVyTWFpbkNhbnZhcy5wdXRJbWFnZURhdGEocGxheWVyTWFpbkltYWdlRGF0YSwgMCwgMCk7XG5cbiAgICAvLyBEcmF3IHBsYXllclxuICAgIHBsYXllck1haW5DYW52YXMuZmlsbFN0eWxlID0gJyNGRjAwMDAnO1xuICAgIHBsYXllck1haW5DYW52YXMuYmVnaW5QYXRoKCk7XG4gICAgcGxheWVyTWFpbkNhbnZhcy5hcmMocGxheWVyLnggKyBkeCwgcGxheWVyLnkgKyBkeSwgMiwgMCwgMiAqIE1hdGguUEkpO1xuICAgIHBsYXllck1haW5DYW52YXMuZmlsbCgpO1xuXG4gICAgLy8gRHJhdyBnb2FsXG4gICAgaWYgKGdvYWwpIHtcbiAgICAgICAgcGxheWVyTWFpbkNhbnZhcy5maWxsU3R5bGUgPSAnIzAwMDBGRic7XG4gICAgICAgIHBsYXllck1haW5DYW52YXMuYmVnaW5QYXRoKCk7XG4gICAgICAgIHBsYXllck1haW5DYW52YXMuYXJjKGdvYWwueCArIGR4LCBnb2FsLnkgKyBkeSwgMiwgMCwgMiAqIE1hdGguUEkpO1xuICAgICAgICBwbGF5ZXJNYWluQ2FudmFzLmZpbGwoKTtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXNldFBsYXllclBhdGgoKTogdm9pZCB7XG4gICAgcGxheWVyUGF0aEltYWdlRGF0YSA9IHBsYXllclBhdGhDYW52YXMuY3JlYXRlSW1hZ2VEYXRhKHdpZHRoICsgMiwgaGVpZ2h0ICsgMik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkcmF3UGxheWVyUGF0aCgpOiB2b2lkIHtcbiAgICBjb25zdCBkeSA9IHN0YXJ0LnkgKyAxO1xuICAgIGNvbnN0IGR4ID0gc3RhcnQueCArIDE7XG4gICAgY29uc3QgeyBkYXRhIH0gPSBwbGF5ZXJQYXRoSW1hZ2VEYXRhO1xuXG4gICAgY29uc3Qgbm9kZXMgPSBjaGFuZ2VzKCk7XG4gICAgZm9yIChsZXQgaSA9IDAsIG4gPSBub2Rlcy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgY29uc3QgeyByb3csIGNvbCwgdmFsdWUgfSA9IG5vZGVzW2ldO1xuICAgICAgICBjb25zdCBwID0gKHJvdyArIGR5KSAqIHcgKyAoY29sICsgZHgpICogNDtcblxuICAgICAgICBzd2l0Y2ggKHZhbHVlKSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgLy8gQ2xvc2VkIG5vZGVcbiAgICAgICAgICAgICAgICBkYXRhW3BdID0gMjU1O1xuICAgICAgICAgICAgICAgIC8vIGRhdGFbcCArIDFdID0gMDtcbiAgICAgICAgICAgICAgICAvLyBkYXRhW3AgKyAyXSA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgLy8gUGF0aCBub2RlXG4gICAgICAgICAgICAgICAgLy8gZGF0YVtwXSA9IDA7XG4gICAgICAgICAgICAgICAgZGF0YVtwICsgMV0gPSAyNTU7XG4gICAgICAgICAgICAgICAgLy8gZGF0YVtwICsgMl0gPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgZGF0YVtwICsgM10gPSAyNTU7XG4gICAgfVxuICAgIHBsYXllclBhdGhDYW52YXMucHV0SW1hZ2VEYXRhKHBsYXllclBhdGhJbWFnZURhdGEsIDAsIDApO1xuICAgIHJlc2V0Q2hhbmdlcygpO1xufVxuIiwiaW1wb3J0IFJheSBmcm9tICcuL3JheSc7XG5pbXBvcnQgeyBnb2FsIH0gZnJvbSAnLi4vc3RvcmUnO1xuaW1wb3J0ICogYXMgcGF0aGZpbmRlciBmcm9tICcuLi9wYXRoZmluZGVyL2Etc3Rhcic7XG5pbXBvcnQgeyBjb3MsIGRpciwgTWVtb3J5Q2hhbmdlTGlzdCwgcmFuZEludCwgc2luLCBzbGVlcCB9IGZyb20gJy4uL3V0aWwnO1xuaW1wb3J0IHsgZHJhd1BsYXllclBhdGgsIHJlc2V0UGxheWVyUGF0aCB9IGZyb20gJy4uL2RyYXcnO1xuXG5jbGFzcyBQbGF5ZXIge1xuICAgIC8vIE1lbW9yeSBsYXllclxuICAgIG1lbW9yeTogTWVtb3J5Q2hhbmdlTGlzdCA9IG5ldyBNZW1vcnlDaGFuZ2VMaXN0KCk7XG5cbiAgICAvLyBNYXAgbGF5ZXJcbiAgICB4OiBudW1iZXI7XG4gICAgeTogbnVtYmVyO1xuICAgIGRpciA9IDA7XG4gICAgcmF5czogUmF5W10gPSBbXTtcbiAgICBwYXRoOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH1bXSA9IFtdO1xuICAgIGdvYWw/OiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH07XG4gICAgcGF0aGZpbmRlcjoge1xuICAgICAgICBpbml0KHBsYXllcjogUGxheWVyLCBlbmQ6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSk6IHZvaWQ7XG4gICAgICAgIGNvbXB1dGUoKTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9W10gfCB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBnb2FsRGlyZWN0aW9uczogeyB4OiBudW1iZXI7IHk6IG51bWJlcjsgZGlyOiBudW1iZXIgfVtdID0gW107XG5cbiAgICBjb25zdHJ1Y3Rvcih4ID0gMCwgeSA9IDAsIG4gPSAzNjApIHtcbiAgICAgICAgdGhpcy54ID0geDtcbiAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgdGhpcy5wYXRoZmluZGVyID0gcGF0aGZpbmRlcjtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAzNjA7IGkgKz0gMzYwIC8gbikgdGhpcy5yYXlzLnB1c2gobmV3IFJheShpLCA1MCkpO1xuICAgIH1cblxuICAgIGZpbmRHb2FsKHN4OiBudW1iZXIsIHN5OiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZ29hbERpcmVjdGlvbnMubGVuZ3RoID4gMTApIHtcbiAgICAgICAgICAgIGNvbnN0IHggPSAxMDA7XG4gICAgICAgICAgICBjb25zdCB5ID0gMDtcblxuICAgICAgICAgICAgZm9yIChjb25zdCB7IHg6IGwxeDEsIHk6IGwxeTEsIGRpcjogbDFkaXIgfSBvZiB0aGlzLmdvYWxEaXJlY3Rpb25zKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbDF4MiA9IGwxeDEgKyBNYXRoLnJvdW5kKHggKiBjb3MobDFkaXIpIC0geSAqIHNpbihsMWRpcikpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGwxeTIgPSBsMXkxICsgTWF0aC5yb3VuZCh4ICogc2luKGwxZGlyKSArIHkgKiBjb3MobDFkaXIpKTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGExID0gbDF5MiAtIGwxeTE7XG4gICAgICAgICAgICAgICAgY29uc3QgYjEgPSBsMXgxIC0gbDF4MjtcbiAgICAgICAgICAgICAgICBjb25zdCBjMSA9IGExICogbDF4MSArIGIxICogbDF5MTtcblxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgeyB4OiBsMngxLCB5OiBsMnkxLCBkaXI6IGwyZGlyIH0gb2YgdGhpcy5nb2FsRGlyZWN0aW9ucykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsMngyID0gbDJ4MSArIE1hdGgucm91bmQoeCAqIGNvcyhsMmRpcikgLSB5ICogc2luKGwyZGlyKSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGwyeTIgPSBsMnkxICsgTWF0aC5yb3VuZCh4ICogc2luKGwyZGlyKSArIHkgKiBjb3MobDJkaXIpKTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhMiA9IGwyeTIgLSBsMnkxO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBiMiA9IGwyeDEgLSBsMngyO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjMiA9IGEyICogbDJ4MSArIGIyICogbDJ5MTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkID0gYTEgKiBiMiAtIGEyICogYjE7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUGFyYWxsZWxcbiAgICAgICAgICAgICAgICAgICAgaWYgKGQgPT09IDApIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ29hbCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHg6IE1hdGgucm91bmQoKGIyICogYzEgLSBiMSAqIGMyKSAvIGQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgeTogTWF0aC5yb3VuZCgoYTEgKiBjMiAtIGEyICogYzEpIC8gZCksXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7IHgsIHksIGRpciB9ID0gdGhpcztcbiAgICAgICAgdGhpcy5nb2FsRGlyZWN0aW9ucy5wdXNoKHsgeDogeCArIHN4LCB5OiB5ICsgc3ksIGRpciB9KTtcbiAgICAgICAgdGhpcy5wYXRoLnB1c2goeyB4OiB4ICsgcmFuZEludCgtMSwgMSksIHk6IHkgKyByYW5kSW50KC0xLCAxKSB9KTtcbiAgICB9XG5cbiAgICBhc3luYyB1cGRhdGUoc3g6IG51bWJlciwgc3k6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBVcGRhdGUgZ29hbCBkaXJlY3Rpb25cbiAgICAgICAgdGhpcy5kaXIgPSBkaXIodGhpcy54ICsgc3gsIHRoaXMueSArIHN5LCBnb2FsLngsIGdvYWwueSk7XG5cbiAgICAgICAgaWYgKHRoaXMueCArIHN4ID09PSB0aGlzLmdvYWw/LnggJiYgdGhpcy55ICsgc3kgPT09IHRoaXMuZ29hbD8ueSkge1xuICAgICAgICAgICAgdGhpcy5nb2FsID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5nb2FsRGlyZWN0aW9ucyA9IFtdO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLmdvYWwpIHRoaXMuZmluZEdvYWwoc3gsIHN5KTtcblxuICAgICAgICBpZiAodGhpcy5nb2FsICYmIHRoaXMucGF0aC5sZW5ndGggPT09IDApIGF3YWl0IHRoaXMuY29tcHV0ZVBhdGgoc3gsIHN5KTtcblxuICAgICAgICBjb25zdCB7IHgsIHkgfSA9IHRoaXMucGF0aC5wb3AoKSE7XG5cbiAgICAgICAgdGhpcy54ID0geDtcbiAgICAgICAgdGhpcy55ID0geTtcblxuICAgICAgICBjb25zdCBvYnN0YWNsZXM6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfVtdID0gW107XG5cbiAgICAgICAgY29uc3QgeyByYXlzLCBtZW1vcnkgfSA9IHRoaXM7XG5cbiAgICAgICAgLy8gQ2FzdCBsaWRhclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgbiA9IHJheXMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCByYXkgPSByYXlzW2ldO1xuICAgICAgICAgICAgY29uc3QgW2NvbGxpZGUsIHBvaW50LCBnb2FsXSA9IHJheS51cGRhdGUodGhpcy54ICsgc3gsIHRoaXMueSArIHN5KTtcblxuICAgICAgICAgICAgLy8gU2V0IGdvYWwgaWYgZm91bmRcbiAgICAgICAgICAgIGlmIChnb2FsKSB7XG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIGdvYWwgZXN0aW1hdGUgdG8gYWN0dWFsIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgdGhpcy5nb2FsID0gZ29hbDtcbiAgICAgICAgICAgICAgICBtZW1vcnkuc2V0KGdvYWwueSAtIHN5LCBnb2FsLnggLSBzeCwgMyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFVuZG8gbW92ZW1lbnQgaWYgaXQgd2lsbCByZXN1bHQgaW4gY29sbGlzaW9uXG4gICAgICAgICAgICBpZiAoY29sbGlkZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgZGlyIH0gPSByYXk7XG4gICAgICAgICAgICAgICAgY29uc3QgZHggPSBNYXRoLnJvdW5kKGNvcyhkaXIpIC0gc2luKGRpcikpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGR5ID0gTWF0aC5yb3VuZChzaW4oZGlyKSArIGNvcyhkaXIpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBhdGggPSBbeyB4OiB4ICsgZHgsIHk6IHkgKyBkeSB9XTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnVwZGF0ZShzeCwgc3kpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBBZGQgZGV0ZWN0ZWQgcG9pbnRcbiAgICAgICAgICAgIGlmIChwb2ludCkgb2JzdGFjbGVzLnB1c2gocG9pbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgbWVtb3J5LnJlc2V0KCk7XG5cbiAgICAgICAgLy8gU2V0IGRldGVjdGVkIHBvaW50cyBpbiBtZW1vcnkgYXMgZGlzY292ZXJlZCBvYnN0YWNsZXNcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIG4gPSBvYnN0YWNsZXMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCB7IHgsIHkgfSA9IG9ic3RhY2xlc1tpXTtcbiAgICAgICAgICAgIGlmIChtZW1vcnkuZ2V0KHkgLSBzeSwgeCAtIHN4KSAhPT0gMikgbWVtb3J5LnNldCh5IC0gc3ksIHggLSBzeCwgMik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZXQgaW50ZWdyYWxzIHdpdGggbm8gZGV0ZWN0aW9uIGluIG1lbW9yeSBhcyBkaXNjb3ZlcmVkIGZyZWUgcG9pbnRzXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBuID0gcmF5cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHsgaW50ZWdyYWxzIH0gPSByYXlzW2ldO1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDAsIG4gPSBpbnRlZ3JhbHMubGVuZ3RoOyBqIDwgbjsgaisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyB4LCB5IH0gPSBpbnRlZ3JhbHNbal07XG4gICAgICAgICAgICAgICAgaWYgKG1lbW9yeS5nZXQoeSAtIHN5LCB4IC0gc3gpICE9PSAxKSBtZW1vcnkuc2V0KHkgLSBzeSwgeCAtIHN4LCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNvbnN0IHsgeCA9IHRoaXMueCwgeSA9IHRoaXMueSB9ID0gcGF0aEZpbmRlci51cGRhdGUoKTtcbiAgICAgICAgLy8gdGhpcy5keCA9IE1hdGgucm91bmQoKHggLSB0aGlzLngpICogY29zKHRoaXMuZGlyKSAtICh5IC0gdGhpcy55KSAqIHNpbih0aGlzLmRpcikpO1xuICAgICAgICAvLyB0aGlzLmR5ID0gTWF0aC5yb3VuZCgoeCAtIHRoaXMueCkgKiBzaW4odGhpcy5kaXIpICsgKHkgLSB0aGlzLnkpICogY29zKHRoaXMuZGlyKSk7XG4gICAgfVxuXG4gICAgYXN5bmMgY29tcHV0ZVBhdGgoc3g6IG51bWJlciwgc3k6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCB7IHBhdGgsIGdvYWwsIHBhdGhmaW5kZXIgfSA9IHRoaXM7XG5cbiAgICAgICAgLy8gUmVjb21wdXRlIHBhdGggaWYgZ29hbCBpcyBmb3VuZCBhbmQgcGF0aCBpcyBub3QgaW5pdGlhbGlzZWQgb3IgcHJvYmxlbWF0aWNcbiAgICAgICAgaWYgKHBhdGgubGVuZ3RoID09PSAwICYmIGdvYWwpIHtcblxuICAgICAgICAgICAgcGF0aGZpbmRlci5pbml0KHRoaXMsIHsgeDogZ29hbC54IC0gc3gsIHk6IGdvYWwueSAtIHN5IH0pO1xuICAgICAgICAgICAgcmVzZXRQbGF5ZXJQYXRoKCk7XG4gICAgICAgICAgICBsZXQgcGF0aDtcbiAgICAgICAgICAgIHdoaWxlICghcGF0aCkge1xuICAgICAgICAgICAgICAgIHBhdGggPSBwYXRoZmluZGVyLmNvbXB1dGUoKTtcbiAgICAgICAgICAgICAgICBkcmF3UGxheWVyUGF0aCgpO1xuICAgICAgICAgICAgICAgIGF3YWl0IHNsZWVwKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBhdGggPSBwYXRoO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5jb25zdCBwbGF5ZXIgPSBuZXcgUGxheWVyKCk7XG5cbmV4cG9ydCBkZWZhdWx0IHBsYXllcjtcblxuZXhwb3J0IHtQbGF5ZXJ9O1xuIiwiaW1wb3J0IHsgVGltZXIgfSBmcm9tICcuL3V0aWwnO1xuaW1wb3J0IHBsYXllciBmcm9tICcuL3BsYXllcic7XG5pbXBvcnQge1xuICAgIGdvYWwsXG4gICAgaGVpZ2h0LFxuICAgIGtleWJvYXJkLFxuICAgIG1hcEJhY2tncm91bmRDYW52YXMsXG4gICAgbWF6ZSxcbiAgICBvYnN0YWNsZXMsXG4gICAgc3RhcnQsXG4gICAgd2lkdGgsXG59IGZyb20gJy4vc3RvcmUnO1xuaW1wb3J0IG1hcCBmcm9tICcuL21hcCc7XG5cbmltcG9ydCB7IGRyYXdNYXAsIGRyYXdQbGF5ZXIgfSBmcm9tICcuL2RyYXcnO1xuXG5jb25zdCB0aW1lciA9IG5ldyBUaW1lcigpO1xuXG5jb25zdCBmcHMgPSAxNDQ7XG5cbmNvbnN0IGRlbGF5ID0gMTAwMCAvIGZwcztcblxuY29uc3QgZnBzRGlzcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmcHMnKSE7XG5jb25zdCBwb3NEaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXllci1wb3MnKSE7XG5jb25zdCBhY3R1YWxQb3NEaXNwbGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXllci1hY3R1YWwtcG9zJykhO1xuY29uc3QgZ29hbEVzdGltYXRlRGlzcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF5ZXItZXN0aW1hdGUnKSE7XG5cbmxldCB0ID0gMDtcblxud2luZG93Lm9ubG9hZCA9IGFzeW5jIGZ1bmN0aW9uICgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zb2xlLmxvZygnTG9hZCBvaycpO1xuXG4gICAgbWFwQmFja2dyb3VuZENhbnZhcy5kcmF3SW1hZ2UobWF6ZSwgMCwgMCk7XG5cbiAgICAvLyBTZXQgc3RhdGljIG9ic3RhY2xlc1xuICAgIG1hcC5zZXQobWFwQmFja2dyb3VuZENhbnZhcy5nZXRJbWFnZURhdGEoMCwgMCwgd2lkdGgsIGhlaWdodCkuZGF0YSk7XG5cbiAgICAvLyBEcmF3IGdvYWwgdG8gbWFwIGJhY2tncm91bmRcbiAgICBtYXBCYWNrZ3JvdW5kQ2FudmFzLmZpbGxTdHlsZSA9ICcjMDAwMEZGJztcbiAgICBtYXBCYWNrZ3JvdW5kQ2FudmFzLmJlZ2luUGF0aCgpO1xuICAgIG1hcEJhY2tncm91bmRDYW52YXMuYXJjKGdvYWwueCwgZ29hbC55LCAyLCAwLCAyICogTWF0aC5QSSk7XG4gICAgbWFwQmFja2dyb3VuZENhbnZhcy5maWxsKCk7XG5cbiAgICBtYXAucmVzZXQoKTtcbiAgICBjb25zb2xlLmxvZygnc3RhcnRpbmcuLi4nKTtcblxuICAgIGluaXQoKTtcbn07XG5cbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aW1lci5zdGFydCgpO1xuXG4gICAgb2JzdGFjbGVzLnVwZGF0ZSgpO1xuXG4gICAgbWFwLnJlc2V0KCk7XG5cbiAgICAvLyBjb25zdCBkeSA9IChrZXlib2FyZC5zID8gLTEgOiAwKSArIChrZXlib2FyZC53ID8gMSA6IDApO1xuICAgIC8vIGNvbnN0IGR4ID0gKGtleWJvYXJkLmQgPyAtMSA6IDApICsgKGtleWJvYXJkLmEgPyAxIDogMCk7XG5cbiAgICBhd2FpdCBwbGF5ZXIudXBkYXRlKHN0YXJ0LngsIHN0YXJ0LnkpO1xuXG4gICAgZHJhdyh1cGRhdGUpO1xufVxuXG5mdW5jdGlvbiBkcmF3KG5leHQ6ICgpID0+IHZvaWQpOiB2b2lkIHtcbiAgICBkcmF3TWFwKCk7XG5cbiAgICBkcmF3UGxheWVyKCk7XG5cbiAgICBwb3NEaXNwbGF5LmlubmVyVGV4dCA9IGBtZW1vcnkgeDogJHtwbGF5ZXIueH0sIHk6ICR7cGxheWVyLnl9YDtcblxuICAgIGdvYWxFc3RpbWF0ZURpc3BsYXkuaW5uZXJUZXh0ID0gcGxheWVyLmdvYWwgPyBgeDogJHtwbGF5ZXIuZ29hbC54fSwgeTogJHtwbGF5ZXIuZ29hbC55fWAgOiAnc2VhcmNoaW5nJztcblxuICAgIGFjdHVhbFBvc0Rpc3BsYXkuaW5uZXJUZXh0ID0gYGFjdHVhbCB4OiAke3BsYXllci54ICsgc3RhcnQueH0sIHk6ICR7cGxheWVyLnkgKyBzdGFydC55fWA7XG5cbiAgICB0ID0gdGltZXIuZW5kKCk7XG5cbiAgICBzZXRUaW1lb3V0KG5leHQsIGRlbGF5IC0gdCk7IC8vIGZpeG1lIGxvb3Bcbn1cblxuLy8gRlBTXG4vLyBzZXRJbnRlcnZhbCgoKSA9PiAoZnBzRGlzcGxheS5pbm5lclRleHQgPSB0ICsgJyBtcyBwZXIgY3ljbGUnKSwgMTAwKTtcbnNldEludGVydmFsKCgpID0+IChmcHNEaXNwbGF5LmlubmVyVGV4dCA9ICdmcHMgJyArIE1hdGguZmxvb3IoMTAwMCAvIHQpKSwgMTAwKTtcblxubGV0IGJlZ2luID0gZmFsc2U7XG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoeyBrZXkgfSkgPT4ge1xuICAgIGlmIChrZXkgPT09ICcgJyAmJiAhYmVnaW4pIGJlZ2luID0gdHJ1ZTtcbn0pO1xuXG5mdW5jdGlvbiBpbml0KCk6IHZvaWQge1xuICAgIGNvbnN0IGR5ID0gKGtleWJvYXJkLnMgPyAtMSA6IDApICsgKGtleWJvYXJkLncgPyAxIDogMCk7XG4gICAgY29uc3QgZHggPSAoa2V5Ym9hcmQuZCA/IC0xIDogMCkgKyAoa2V5Ym9hcmQuYSA/IDEgOiAwKTtcblxuICAgIC8vIHBsYXllci54ICs9IGR4O1xuICAgIC8vIHBsYXllci55ICs9IGR5O1xuICAgIHN0YXJ0LnggKz0gZHg7XG4gICAgc3RhcnQueSArPSBkeTtcblxuICAgIGlmIChiZWdpbikgZHJhdyh1cGRhdGUpO1xuICAgIGVsc2UgZHJhdyhpbml0KTtcbn1cbiIsImltcG9ydCBwbGF5ZXIgZnJvbSAnLi4vcGxheWVyJztcbmltcG9ydCB7IGNvcywgc2luIH0gZnJvbSAnLi4vdXRpbCc7XG5pbXBvcnQgeyBoZWlnaHQsIG1hcE1haW5DYW52YXMsIG9ic3RhY2xlcywgd2lkdGgsIHN0YXJ0IH0gZnJvbSAnLi4vc3RvcmUnO1xuXG5leHBvcnQgZnVuY3Rpb24gZHJhd01hcCgpOiB2b2lkIHtcbiAgICBtYXBNYWluQ2FudmFzLmNsZWFyUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgIC8vIERyYXcgcmF5c1xuICAgIG1hcE1haW5DYW52YXMuc3Ryb2tlU3R5bGUgPSAnI0NEQ0RDRCc7XG5cbiAgICBjb25zdCB7IHJheXMsIGRpciB9ID0gcGxheWVyO1xuICAgIGZvciAobGV0IHIgPSAwLCBuID0gcmF5cy5sZW5ndGg7IHIgPCBuOyByKyspIHtcbiAgICAgICAgY29uc3QgaW50ID0gcmF5c1tyXS5pbnRlZ3JhbHM7XG5cbiAgICAgICAgaWYgKGludFswXSkge1xuICAgICAgICAgICAgbWFwTWFpbkNhbnZhcy5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIG1hcE1haW5DYW52YXMubW92ZVRvKGludFswXS54LCBpbnRbMF0ueSk7XG4gICAgICAgICAgICBtYXBNYWluQ2FudmFzLmxpbmVUbyhpbnRbaW50Lmxlbmd0aCAtIDFdLngsIGludFtpbnQubGVuZ3RoIC0gMV0ueSk7XG4gICAgICAgICAgICBtYXBNYWluQ2FudmFzLnN0cm9rZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbWFwTWFpbkNhbnZhcy5maWxsU3R5bGUgPSAnIzAwMDAwMCc7XG4gICAgb2JzdGFjbGVzLmZvckVhY2goKHsgeCwgeSB9KSA9PiB7XG4gICAgICAgIG1hcE1haW5DYW52YXMuZmlsbFJlY3QoeCwgeSwgMSwgMSk7XG4gICAgICAgIG1hcE1haW5DYW52YXMuZmlsbCgpO1xuICAgIH0pO1xuXG4gICAgY29uc3Qgc3ggPSBwbGF5ZXIueCArIHN0YXJ0Lng7XG4gICAgY29uc3Qgc3kgPSBwbGF5ZXIueSArIHN0YXJ0Lnk7XG5cbiAgICAvLyAvLyBEcmF3IGRpcmVjdGlvbiBvZiBnb2FsXG4gICAgLy8gbWFwTWFpbkNhbnZhcy5zdHJva2VTdHlsZSA9ICcjMDAwMEZGJztcbiAgICAvLyBtYXBNYWluQ2FudmFzLmJlZ2luUGF0aCgpO1xuICAgIC8vXG5cbiAgICAvL1xuICAgIC8vIGNvbnN0IHggPSAxMDA7XG4gICAgLy8gY29uc3QgeSA9IDA7XG4gICAgLy9cbiAgICAvLyBtYXBNYWluQ2FudmFzLm1vdmVUbyhzeCwgc3kpO1xuICAgIC8vIG1hcE1haW5DYW52YXMubGluZVRvKFxuICAgIC8vICAgICBzeCArIE1hdGgucm91bmQoeCAqIGNvcyhkaXIpIC0geSAqIHNpbihkaXIpKSxcbiAgICAvLyAgICAgc3kgKyBNYXRoLnJvdW5kKHggKiBzaW4oZGlyKSArIHkgKiBjb3MoZGlyKSlcbiAgICAvLyApO1xuICAgIC8vIG1hcE1haW5DYW52YXMuc3Ryb2tlKCk7XG5cbiAgICAvLyBEcmF3IHBsYXllclxuICAgIG1hcE1haW5DYW52YXMuZmlsbFN0eWxlID0gJyNGRjAwMDAnO1xuICAgIG1hcE1haW5DYW52YXMuYmVnaW5QYXRoKCk7XG4gICAgbWFwTWFpbkNhbnZhcy5hcmMoc3gsIHN5LCAyLCAwLCAyICogTWF0aC5QSSk7XG4gICAgbWFwTWFpbkNhbnZhcy5maWxsKCk7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9